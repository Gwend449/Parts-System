# โ ะคะธะฝะฐะปัะฝัะน ะงะตะบ-ะปะธัั

## ๐ ะะ ะะะะะะะขะซะะะะะฏ ะ PRODUCTION

### ะจะฐะณ 1: ะัะพะฒะตัะบะฐ ะบะพะดะฐ
- [ ] ะัะต ัะฐะนะปั ะดะพะฑะฐะฒะปะตะฝั ะฒ git
- [ ] ะะตั ัะธะฝัะฐะบัะธัะตัะบะธั ะพัะธะฑะพะบ: `php artisan tinker` ะธ `exit`
- [ ] ะะพะธะดั ะฟัะพัะพะดัั: `php artisan make:cache:clear`
- [ ] ะขะตััั ะฟัะพัะพะดัั: `php artisan test`

### ะจะฐะณ 2: ะะพะบะฐะปัะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต
- [ ] ะกะพะทะดะฐะฝั ัะธะผะฒะพะปะธัะตัะบะธะต ัััะปะบะธ: `php artisan storage:link`
- [ ] ะะฐะณััะทะธะปะธ ัะตััะพะฒะพะต ะธะทะพะฑัะฐะถะตะฝะธะต ะฒ ะฐะดะผะธะฝะบะต
- [ ] ะัะพะฒะตัะธะปะธ ััะพ ะบะพะฝะฒะตััะธะธ ัะพะทะดะฐะปะธัั: `php artisan images:test-conversions`
- [ ] ะะฐะทะผะตั ัะฐะนะปะฐ ~45 KB (ะฒะผะตััะพ 2.5 MB)
- [ ] ะฃะดะฐะปะธะปะธ ัะตััะพะฒะพะต ะธะทะพะฑัะฐะถะตะฝะธะต ัะตัะตะท ะฐะดะผะธะฝะบั
- [ ] ะัะพะฒะตัะธะปะธ ััะพ ัะฐะนะป ัะดะฐะปะตะฝ ะธะท ััะฐะฝะธะปะธัะฐ

### ะจะฐะณ 3: Performance Audit
- [ ] ะัะบััะปะธ DevTools (F12) โ Network tab
- [ ] ะะฐะณััะทะธะปะธ ะบะฐัะฐะปะพะณ
- [ ] ะะฐะทะผะตั ะธะทะพะฑัะฐะถะตะฝะธะน < 100 KB (ะฒะผะตััะพ > 1 MB)
- [ ] ะัะตะผั ะทะฐะณััะทะบะธ < 3 ัะตะบ (ะฒะผะตััะพ > 15 ัะตะบ)
- [ ] ะัะพะฒะตัะธะปะธ ััะพ ะธัะฟะพะปัะทััััั ะบะพะฝะฒะตััะธะธ (thumb)

### ะจะฐะณ 4: Browser Caching
- [ ] ะัะบััะปะธ 2 ัะฐะทะฐ ะพะดะฝั ัััะฐะฝะธัั ะบะฐัะฐะปะพะณะฐ
- [ ] ะัะพัะพะน ัะฐะท ะธะทะพะฑัะฐะถะตะฝะธั ะทะฐะณััะทะธะปะธัั ะธะท ะบััะฐ
- [ ] DevTools ะฟะพะบะฐะทัะฒะฐะตั status "200 from disk cache"

---

## ๐ ะะ ะะฃะจะะะะ ะะ DEV

### ะะพะผะผะธั
```bash
# ะฃะฑะตะดะธัะตัั ััะพ ัะฐะฑะพัะฐะตั ะปะพะบะฐะปัะฝะพ
php artisan tinker
>>> Engine::find(1)->getAllImages()
>>> exit

# ะะพะผะผะธัััะต ั ะฟัะฐะฒะธะปัะฝัะผ ัะพะพะฑัะตะฝะธะตะผ
git add .
git commit -m "feat: optimize image loading and add delete functionality

- Add ImageOptimizationService for image conversions
- Implement media caching (24h) for fast catalog loading
- Add ability to delete images in admin panel
- Optimize nginx with gzip and aggressive caching
- Add test command for conversions verification"

git push origin dev
```

---

## ๐ ะะ DEV ะะะะฃะะะะะ

### ะคัะพะฝัะตะฝะด ัะตะฟะพ (ะตัะปะธ ะพัะดะตะปัะฝะพ)
- [ ] ะะธะบะฐะบะธั ะธะทะผะตะฝะตะฝะธะน ะฝะต ััะตะฑัะตััั
- [ ] ะคัะพะฝัะตะฝะด ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฑัะดะตั ะบััะธัะพะฒะฐัั ะธะทะพะฑัะฐะถะตะฝะธั

### Backend ัะฐะทัะฐะฑะพััะธะบะธ
- [ ] ะะฐะนัะต ะฒัะตะผ ัััะปะบั ะฝะฐ IMPLEMENTATION_GUIDE.md
- [ ] ะะฐััะบะฐะถะธัะต ะพ ะฝะพะฒัั ะฒะพะทะผะพะถะฝะพัััั
- [ ] ะะพะบะฐะถะธัะต ะบะฐะบ ัะดะฐะปััั ะธะทะพะฑัะฐะถะตะฝะธั

### ะขะตััะธัะพะฒะฐะฝะธะต ะฝะฐ DEV
```bash
# ะะฐ ัะตัะฒะตัะต dev
php artisan migrate
php artisan storage:link
php artisan cache:clear
php artisan config:clear

# ะะฐะณััะทะธัะต ะธะทะพะฑัะฐะถะตะฝะธะต ะดะปั ะผะพัะพัะฐ ัะตัะตะท ะฐะดะผะธะฝะบั
# ะัะพะฒะตัััะต ัะบะพัะพััั ะทะฐะณััะทะบะธ ะบะฐัะฐะปะพะณะฐ
# ะะพะฟัะพะฑัะนัะต ัะดะฐะปะธัั ะธะทะพะฑัะฐะถะตะฝะธะต
```

---

## ๐ ะะ ะะะะะะะกะ ะะ PRODUCTION

### ะะตะทะตัะฒะฝะฐั ะบะพะฟะธั
- [ ] ะกะดะตะปะฐะปะธ backup ะะ
- [ ] ะกะดะตะปะฐะปะธ backup storage/app/public/ (ะตัะปะธ ะตััั ััะฐััะต ัะพัะพ)
- [ ] ะกะดะตะปะฐะปะธ backup nginx.conf

### ะะพะดะณะพัะพะฒะบะฐ ัะตัะฒะตัะฐ
- [ ] ะฃะฑะตะดะธัะตัั ััะพ php-gd ัััะฐะฝะพะฒะปะตะฝะฐ: `php -m | grep gd`
- [ ] ะะพััะฐัะพัะฝะพ ะผะตััะฐ ะฒ storage: `df -h storage/`
- [ ] ะกะดะตะปะฐะปะธ deployment ะฝะฐ staging ัะตัะฒะตั (ะตัะปะธ ะตััั)

### ะคะธะฝะฐะปัะฝะฐั ะฟัะพะฒะตัะบะฐ ะฟะตัะตะด ะดะตะฟะปะพะตะผ
```bash
# ะะฐ production
git pull origin dev
php artisan migrate --force
php artisan storage:link
php artisan cache:clear
php artisan config:clear
php artisan optimize

# ะะตัะตะทะฐะณััะทะธัะต php-fpm
systemctl restart php8.3-fpm  # ะธะปะธ ะฒะฐัะฐ ะฒะตััะธั

# ะะตัะตะทะฐะณััะทะธัะต nginx
systemctl reload nginx
```

---

## โก PRODUCTION DEPLOYMENT CHECKLIST

### 1. Backup & Safety
- [ ] ะะพะปะฝัะน backup ะะ ะธ storage ะฒัะฟะพะปะฝะตะฝ
- [ ] ะะตะทะตัะฒะฝะฐั ะบะพะฟะธั nginx.conf ัะพััะฐะฝะตะฝะฐ
- [ ] ะะปะฐะฝ ะพัะบะบะฐัะฐ ะณะพัะพะฒ (git revert)

### 2. Code Deployment
- [ ] `git pull origin main` (ะตัะปะธ main ะฒะตัะบะฐ)
- [ ] `php artisan migrate`
- [ ] `php artisan cache:clear`
- [ ] `php artisan config:clear`

### 3. Filesystem & Links
- [ ] `php artisan storage:link` ะฒัะฟะพะปะฝะตะฝะฐ
- [ ] ะะฐะฟะบะฐ storage/app/public/ ัััะตััะฒัะตั
- [ ] ะัะฐะฒะฐ ะดะพัััะฟะฐ ะฟัะฐะฒะธะปัะฝัะต: `755` ะดะปั ะฟะฐะฟะพะบ, `644` ะดะปั ัะฐะนะปะพะฒ

### 4. Nginx Configuration
- [ ] nginx.conf ะทะฐะผะตะฝะตะฝะฐ ะฝะฐ ะฝะพะฒัั ะฒะตััะธั
- [ ] `nginx -t` ะฝะต ะฟะพะบะฐะทัะฒะฐะตั ะพัะธะฑะพะบ
- [ ] `systemctl reload nginx` ะฒัะฟะพะปะฝะตะฝะฐ ะฑะตะท ะพัะธะฑะพะบ

### 5. PHP Configuration
- [ ] `php -m | grep gd` - ัะฐััะธัะตะฝะธะต ัััะฐะฝะพะฒะปะตะฝะพ
- [ ] `php -v` - PHP ะฒะตััะธั ัะพะฒะผะตััะธะผะฐ
- [ ] `systemctl restart php-fpm` ะฒัะฟะพะปะฝะตะฝะฐ

### 6. Testing on Production
```bash
# ะัะพะฒะตัััะต ััะพ ะฒัั ัะฐะฑะพัะฐะตั
curl -H "Accept-Encoding: gzip" https://yourdomain.ru/storage/ -I
# ะะพะปะถะฝะพ ะฑััั: Content-Encoding: gzip

# ะัะพะฒะตัััะต ะบัั ะทะฐะณะพะปะพะฒะบะธ
curl -I https://yourdomain.ru/storage/1/image.jpg
# ะะพะปะถะฝะพ ะฑััั: Cache-Control: public, max-age=604800

# ะัะพะฒะตัััะต ะบะพะฝะฒะตััะธะธ
# ะัะบัะพะนัะต ะฐะดะผะธะฝะบั ะธ ะทะฐะณััะทะธัะต ะธะทะพะฑัะฐะถะตะฝะธะต
# ะัะพะฒะตัััะต ััะพ ะพะฝะพ ะฑััััะพ ะทะฐะณััะทะธะปะพัั
```

### 7. Monitoring
- [ ] ะกะผะพััะธัะต error ะปะพะณะธ: `tail -f /var/log/nginx/error.log`
- [ ] ะกะผะพััะธัะต application ะปะพะณะธ: `tail -f storage/logs/laravel.log`
- [ ] ะัะพะฒะตัััะต ัะฐะทะผะตั storage: `du -sh storage/app/public/`
- [ ] ะะพะฝะธัะพัััะต CPU/Memory ะธัะฟะพะปัะทะพะฒะฐะฝะธะต

---

## ๐ ะะะะะะะะ ะะะกะะ DEPLOYMENT

### ะะดะผะธะฝะบะฐ
- [ ] ะะพะณะธะฝ ัะฐะฑะพัะฐะตั
- [ ] ะะพะณั ัะพะทะดะฐัั/ัะตะดะฐะบัะธัะพะฒะฐัั ะผะพัะพั
- [ ] ะะฐะณััะทะบะฐ ะธะทะพะฑัะฐะถะตะฝะธั ัะฐะฑะพัะฐะตั ะฑััััะพ (~2 ัะตะบ)
- [ ] ะะพะณั ัะดะฐะปะธัั ะธะทะพะฑัะฐะถะตะฝะธะต (ะตัะปะธ ัะตะฐะปะธะทะพะฒะฐะฝะพ ะฒ UI)
- [ ] ะกะฟะธัะพะบ ะผะพัะพัะพะฒ ะทะฐะณััะถะฐะตััั ะฑััััะพ

### ะะฐัะฐะปะพะณ (ััะพะฝัะตะฝะด)
- [ ] ะะฐัะฐะปะพะณ ัะพะฒะฐัะพะฒ ะทะฐะณััะถะฐะตััั ะฑััััะพ (~1-3 ัะตะบ)
- [ ] ะะทะพะฑัะฐะถะตะฝะธั ะฒะธะดะฝั ะธ ะบัะฐัะธะฒัะต
- [ ] ะัะธ ะฒัะพัะพะผ ะพัะบัััะธะธ ะตัะต ะฑััััะตะต (ะบัั ะฑัะฐัะทะตัะฐ)
- [ ] ะะฐ ะผะพะฑะธะปัะฝะพะผ ะณััะทะธััั ะฑััััะพ

### Performance
```bash
# ะัะพะฒะตัััะต ัะฐะทะผะตั ะฟะตัะตะดะฐัะธ
# DevTools โ Network โ XHR โ ะะฐะบะฐะท ะฒัะตั resources
# ะกัะฐะฒะฝะธัะต "transferred" ั ัะฐะทะผะตัะพะผ ะฒ ะบะฐัะฐะปะพะณะต

# ะัะปะพ: 7.5 MB for 3 images
# ะกัะฐะปะพ: ~150 KB for 3 images thumbnail

# ะญัะพ ะดะพะปะถะฝะพ ะฑััั ะฒะธะดะฝะพ ะฒ 50x ัะฐะท ะผะตะฝััะต!
```

### Database
- [ ] `php artisan tinker`
- [ ] `>>> Engine::find(1)->getMediaList()`
- [ ] ะะพะปะถะฝั ะฒะตัะฝััััั ะฒัะต ะผะตะดะธะฐ

### Cache
- [ ] `php artisan tinker`
- [ ] `>>> Cache::get('engine_images_1')`
- [ ] ะะตัะฒัะน ะทะฐะฟัะพั null, ะฒัะพัะพะน - ะดะฐะฝะฝัะต

---

## ๐จ ะะกะะ ะงะขะ-ะขะ ะะะจะะ ะะ ะขะะ

### ะัะพะฑะปะตะผะฐ: ะะตะปัะน ัะบัะฐะฝ ะฝะฐ ะฐะดะผะธะฝะบะต

**ะะตัะตะฝะธะต:**
```bash
php artisan config:clear
php artisan cache:clear
php artisan storage:link

# ะกะผะพััะธัะต ะพัะธะฑะบะธ
tail -f storage/logs/laravel.log
```

### ะัะพะฑะปะตะผะฐ: ะะทะพะฑัะฐะถะตะฝะธั ะฝะต ะทะฐะณััะถะฐัััั

**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัััะต ััะพ ะบะพะฝะฒะตััะธะธ ะตััั
ls -la storage/app/public/1/conversions/

# ะัะพะฒะตัััะต ะฟัะฐะฒะฐ
chmod -R 755 storage/app/public/

# ะะตัะตัะพะทะดะฐะนัะต symlink
rm public/storage
php artisan storage:link
```

### ะัะพะฑะปะตะผะฐ: ะะตะดะปะตะฝะฝะฐั ะทะฐะณััะทะบะฐ ะฐะดะผะธะฝะบะธ

**ะะตัะตะฝะธะต:**
```bash
# ะะพะถะตั ะฑััั ะฟัะพะฑะปะตะผะฐ ั ะบะพะฝะฒะตััะธัะผะธ
# ะัะบะปััะธัะต queue_conversions_by_default ะฒัะตะผะตะฝะฝะพ
# ะััะตะดะฐะบัะธััะนัะต config/media-library.php:

'queue_conversions_by_default' => false,  // ะฒัะตะผะตะฝะฝะพ false

php artisan config:clear
# ะะฐะณััะทะธัะต ะธะทะพะฑัะฐะถะตะฝะธะต
# ะะพัะพะผ ะฒะตัะฝะธัะต ะฝะฐ true
```

### ะัะพะฑะปะตะผะฐ: ะัั ะฝะต ะพัะธัะฐะตััั

**ะะตัะตะฝะธะต:**
```bash
# ะกะผะพััะธัะต ะบะฐะบะพะน ะดัะฐะนะฒะตั ะธัะฟะพะปัะทัะตััั
php artisan config:get cache.default

# ะัะปะธ file:
rm -rf storage/framework/cache/

# ะัะปะธ redis:
redis-cli FLUSHALL

php artisan cache:clear
```

---

## ๐ ะะะะขะะะขะซ ะะะฏ ะะะะะฉะ

### ะัะปะธ ะฝัะถะฝะฐ ะฟะพะดะดะตัะถะบะฐ:

1. **ะัะพะฒะตัััะต ะปะพะณะธ:**
   ```bash
   tail -n 100 storage/logs/laravel.log
   ```

2. **ะะบะปััะธัะต ะดะตะฑะฐะณ ะผะพะด (ะฒัะตะผะตะฝะฝะพ):**
   ```bash
   APP_DEBUG=true php artisan ...
   ```

3. **ะัะธััะธัะต ะฒัั:**
   ```bash
   php artisan cache:clear
   php artisan config:clear
   php artisan view:clear
   ```

4. **ะะตัะตะทะฐะณััะทะธัะต services:**
   ```bash
   systemctl restart php-fpm
   systemctl reload nginx
   ```

---

## ๐ ะะะขะะะะ ะะะฏ ะะขะกะะะะะะะะะฏ

ะะพัะปะต deployment ะผะพะฝะธัะพัััะต:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะะขะะะะ          โ ะะซะะ    โ ะกะขะะะ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ะะฐะทะผะตั image     โ 2.5 MB  โ 45 KB  โ
โ ะะฐะณััะทะบะฐ ะบะฐัะฐะปะพะณ โ 15-30s  โ 1-3s   โ
โ ะขัะฐัะธะบ 3 ัะพัะพ    โ 7.5 MB  โ 150 KB โ
โ ะะฐะผััั ะฑัะฐัะทะตัะฐ  โ ะััะพะบะฐั โ ะะธะทะบะฐั โ
โ CPU ะฐะดะผะธะฝะบะฐ      โ 50-80%  โ 20-30% โ
โ Disk usage       โ ะะฐััะตั  โ ะะพะฝััะพะปะธััะตััั
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะัะพะฒะตััะนัะต ััะธ ะผะตััะธะบะธ ะทะฐ ะฝะตะดะตะปั ะฟะพัะปะต ัะฐะทะฒะตัััะฒะฐะฝะธั.

---

## โจ ะฃะกะะะจะะะ ะะะะะะะขะซะะะะะ = โ

- โ ะะดะผะธะฝะบะฐ ัะฐะฑะพัะฐะตั ะฑััััะพ
- โ ะะฐัะฐะปะพะณ ะณััะทะธััั < 3 ัะตะบ
- โ ะะทะพะฑัะฐะถะตะฝะธั ~45 KB (ะฒะผะตััะพ 2.5 MB)
- โ ะฃะดะฐะปะตะฝะธะต ัะพัะพะณัะฐัะธะน ัะฐะฑะพัะฐะตั
- โ ะะตั ะพัะธะฑะพะบ ะฒ ะปะพะณะฐั
- โ ะัะฐัะทะตั ะบััะธััะตั ะฝะฐ 30 ะดะฝะตะน
- โ ะะ ะธ storage ะฒ ะฝะพัะผะต

**ะะะะะะะะะฏะะ! ๐ ะะฟัะธะผะธะทะฐัะธั ะทะฐะฒะตััะตะฝะฐ ััะฟะตัะฝะพ!**

---

**ะะตััะธั**: 1.0
**ะะฐัะฐ**: December 30, 2025
**ะกัะฐััั**: Production Ready
